--- ixgbe-3.11.33/src/ixgbe_main.c~	2012-10-04 17:39:15.000000000 +0200
+++ ixgbe-3.11.33/src/ixgbe_main.c	2012-12-20 13:58:51.727606335 +0100
@@ -9108,7 +9108,11 @@
 		goto skip_bad_vf_detection;
 
 	bdev = pdev->bus->self;
+#if ( LINUX_VERSION_CODE < KERNEL_VERSION(3,7,0) )
 	while (bdev && (bdev->pcie_type != PCI_EXP_TYPE_ROOT_PORT))
+#else
+	while (bdev && (pci_pcie_type(bdev) != PCI_EXP_TYPE_ROOT_PORT))
+#endif
 		bdev = bdev->bus->self;
 
 	if (!bdev)
